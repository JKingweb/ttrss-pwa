<div fxLayout="column" fxLayoutAlign="space-between stretch" fxFlex="1 1 auto">
  <button id="menu-button" mat-icon-button (click)="snav.toggle()" aria-label="Menu" [style.display]="isMobile ? 'block' : 'none'">
    <mat-icon>menu</mat-icon>
  </button>
  <mat-sidenav-container autosize class="ttrss-sidenav-container" style="height:100%;" fxFlex="1 1 auto">
    <mat-sidenav #snav id="sidenav" [mode]="isMobile ? 'over' : 'side'" [opened]="!isMobile" role="navigation">
      <mat-nav-list [class.list-indent]="isMobile">
        <div *ngFor="let cat of categories">
          <h2 mat-subheader (click)="onSelect(cat);">{{cat.title}}</h2>
          <mat-list-item *ngFor="let feed of feeds | feedFilter:cat.id" (click)="onSelect(feed);" [class.selected]="feed === selectedFeed">
            <img *ngIf="feed.id>0; else matIcon" [src]="client.getFeedIconURL(feed.id)" width="auto" height="24px"
            />
            <ng-template #matIcon>
              <mat-icon mat-list-icon>{{ client.getFeedIconURL(feed.id) }}</mat-icon>
            </ng-template>
            <a mat-list-item fxFlex="1 1 auto">{{feed.title}}</a>
            <span mat-list-item>{{feed.unread}}</span>
          </mat-list-item>
          <mat-divider></mat-divider>
        </div>
      </mat-nav-list>
    </mat-sidenav>

    <mat-sidenav-content role="main" id="feedView">
      <mat-toolbar #feedtoolbar class="ttrss-toolbar">
        <!-- <mat-toolbar-row> -->
        <h1 *ngIf="selectedFeed;else defaultHead" [class.menu-indent]="isMobile">
          <img *ngIf="selectedFeed.id>0 && !is_cat;else matFeedIcon" [src]="client.getFeedIconURL(selectedFeed.id)"
            width="auto" height="24px" />
          <ng-template #matFeedIcon>
            <mat-icon mat-list-icon>{{ client.getFeedIconURL(selectedFeed.id, is_cat) }}</mat-icon>
          </ng-template>
          <span>{{ selectedFeed.title }}</span>
        </h1>
        <ng-template #defaultHead>
          <h1 class="ttrss-app-name" [class.menu-indent]="isMobile">{{'title' | translate}}</h1>
        </ng-template>
        <div class="tb-buttons">
          <mat-button-toggle mat-icon-button [matTooltip]="'TB_Multiselect' | translate" matTooltipShowDelay="1000"
            style="vertical-align: middle;" *ngIf="selectedFeed" [checked]="multiSelectEnabled"
            (change)="multiselectChanged($event.source.checked)">
            <mat-icon>done_all</mat-icon>
          </mat-button-toggle>
          <button mat-raised-button [matTooltip]="'TB_ToggleStar' | translate" matTooltipShowDelay="1000"
            (click)="updateSelected(0, 2)" *ngIf="multiSelectEnabled">
            <mat-icon>star</mat-icon>
          </button>
          <button mat-raised-button [matTooltip]="'TB_ToggleRead' | translate" matTooltipShowDelay="1000"
            (click)="updateSelected(2, 2)" *ngIf="selectedFeed">
            <mat-icon>mail</mat-icon>
          </button>
          <button mat-icon-button [matMenuTriggerFor]="appMenu" aria-label="More">
            <mat-icon>more_vert</mat-icon>
          </button>
        </div>
        <mat-menu #appMenu>
          <a mat-icon-button aria-label="Settings" routerLink="/settings">
            <mat-icon>settings</mat-icon>{{'Settings' | translate }}
          </a>
        </mat-menu>
      </mat-toolbar>
      <div #feedList class="clearFloat" *ngIf="selectedFeed;else noFeed" infiniteScroll (scrolled)="loadHeadlines()"
        [scrollWindow]="false" [infiniteScrollContainer]="'#feedView'" [fromRoot]="true">
        <mat-nav-list id="headlist" role="list" *ngIf="headlines && headlines.length>0;else emtpyList">
          <div role="listitem" *ngFor="let head of headlines" fxLayout="row">
            <mat-checkbox *ngIf="multiSelectEnabled" fxFlexAlign="center" [checked]="multiSelectedHeadlines.includes(head)"
              (change)="onArticleSelect(head)"></mat-checkbox>
            <div fxLayout="column" fxFlex="1 1 auto">
              <ttrss-article [multiSelectEnabled]="multiSelectEnabled" [feed]="selectedFeed" [article]="head"
                (click)="onArticleSelect(head);" [selected]="selectedHeadline && head===selectedHeadline"
                fxFlex="1 1 auto"></ttrss-article>
              <mat-toolbar #articletoolbar class="article-toolbar" *ngIf="selectedHeadline && head===selectedHeadline">
                <button mat-raised-button [matTooltip]="'TB_Unstar' | translate" matTooltipShowDelay="1000"
                  *ngIf="selectedHeadline.marked" (click)="updateSelected(0, 0)">
                  <mat-icon>star_border</mat-icon>
                </button>
                <button mat-raised-button [matTooltip]="'TB_Star' | translate" matTooltipShowDelay="1000" (click)="updateSelected(0, 2)"
                  *ngIf="!selectedHeadline.marked">
                  <mat-icon>star</mat-icon>
                </button>
                <button mat-raised-button [matTooltip]="'TB_MarkUnread' | translate" matTooltipShowDelay="1000"
                  *ngIf="!selectedHeadline.unread" (click)="updateSelected(2, 0)">
                  <mat-icon>mail</mat-icon>
                </button>
                <button mat-raised-button [matTooltip]="'TB_MarkRead' | translate" matTooltipShowDelay="1000"
                  (click)="updateSelected(2, 2)" *ngIf="selectedHeadline.unread">
                  <mat-icon>drafts</mat-icon>
                </button>
              </mat-toolbar>
              <mat-divider></mat-divider>
            </div>
          </div>
        </mat-nav-list>
        <ng-template #emtpyList>
          <p style="text-align: center;">{{'NoHeadlines' | translate}}</p>
        </ng-template>
      </div>
      <ng-template #noFeed>
        <p class="clearFloat" style="text-align: center;">{{'NoFeed' | translate}}</p>
      </ng-template>
    </mat-sidenav-content>
  </mat-sidenav-container>
</div>